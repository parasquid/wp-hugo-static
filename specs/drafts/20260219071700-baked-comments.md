# Draft: Baked Comments Feature

## Requirements (confirmed)
- **Core objective**: Bake GitHub Discussions comments into static HTML for SEO while keeping Giscus for interactivity
- **Discussion organization**: Per-Post Categories (each post has its own discussion)
- **GitHub token**: Use existing GITHUB_TOKEN from workflow
- **Data fetching strategy**: Skip closed discussions. Full fetch is overwritten by triggered builds anyway, so fetch all discussions and filter to only OPEN discussions (comments closed after 30 days by default).

## Technical Decisions
- **Script language**: Ruby (consistent with existing fetch-posts.rb, fetch-pages.rb)
- **Data storage**: JSON files in hugo-site/data/comments/{slug}.json
- **Template approach**: Hugo template to render static comments, with JS to hide after Giscus loads
- **API**: GitHub GraphQL API for discussions

## Research Findings
- Existing giscus.html partial found at hugo-site/layouts/partials/comments/giscus.html
- CI/CD workflow in .github/workflows/deploy.yml with Ruby setup
- Existing scripts follow pattern: OUTPUT_DIR, clean_filename, fetch_*, process_*
- No existing hugo-site/data/ directory - will need to create

## Scope Boundaries
- INCLUDE: 
  - scripts/fetch-comments.rb (skip closed discussions)
  - hugo-site/data/comments/ directory
  - Hugo template for static comment rendering
  - Updated giscus.html with baked comments + JS hide logic
  - CI/CD integration
- EXCLUDE:
  - GitHub Discussions setup (already exists per user)
  - Giscus app installation (user has this)
  - Time-based filtering (not needed - skip closed instead)
